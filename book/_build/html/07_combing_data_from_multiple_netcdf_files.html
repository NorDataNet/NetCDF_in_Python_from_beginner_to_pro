

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>07: Combining data from multiple netcdf files &#8212; NetCDF in Python - from beginner to pro</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '07_combing_data_from_multiple_netcdf_files';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="NetCDF in Python - from beginner to pro - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="NetCDF in Python - from beginner to pro - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    NetCDF in Python: From beginner to pro
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_opening_and_understanding.html">01: Opening and understanding</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_creating_plots.html">02: Creating Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_extracting_data_to_different_formats.html">03: Extracting data to different formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_creating_a_cfnetcdf_file.html">04: Creating a CF-NetCDF file</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_how_to_structure_your_NetCDF_file_or_files.html">05: How to structure you NetCDF file or files</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_creating_multiple_cfnetcdf_files_in_one_go.html">06: Creating multiple CF-NetCDF files in one go</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lhmarsden/NetCDF_in_Python_from_beginner_to_pro" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lhmarsden/NetCDF_in_Python_from_beginner_to_pro/issues/new?title=Issue%20on%20page%20%2F07_combing_data_from_multiple_netcdf_files.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/07_combing_data_from_multiple_netcdf_files.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>07: Combining data from multiple netcdf files</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-the-data">Introducing the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#looping-through-multiple-files">Looping through multiple files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-data-from-all-the-files-into-a-csv-or-xlsx-file">Combining data from all the files into a CSV or XLSX file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-data">Plotting the data</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="combining-data-from-multiple-netcdf-files">
<h1>07: Combining data from multiple netcdf files<a class="headerlink" href="#combining-data-from-multiple-netcdf-files" title="Permalink to this heading">#</a></h1>
<p>In some cases, people will choose to break down their data into multiple smaller netcdf files that they will publish in a single data collection. There are a number of good reasons to do this.</p>
<ul class="simple">
<li><p>The data user can access only the data they are interested in.</p></li>
<li><p>Each file can be simpler with potentially less dimensions and less missing values. Imagine you have 10 depth profiles that all sample a different set of depths. If these profiles were included in a single netcdf file, the file would most likely a single depth dimension and coordinate variable which would need to account for all 10 depth profiles. Alternatively, 10 depth dimensions and coordinate variables could be included.</p></li>
<li><p>Each individual file can be assigned a separate set of global attributes which describe the data more accurately. For example each file could have global attributes for the coordinates and timestamp. If multiple depth profiles are stored in a single file, only the minimum and maximum coordinates and timestamp can be encoded into the global attributes.</p></li>
<li><p>Imagine you are looking for data in a data centre. You want to find depth profiles in a certain area of interest on a map. Files that include a single depth profile will be presented as points on the map. Files that include multiple depth profiles will be presented as a bounding box on a map, and without opening up the file it could be unclear whether the file includes data for your area of interest.</p></li>
</ul>
<p>A common reaction to learning that data are divided into multiple files is that extracting the data will involve more work. However, if the files are similar (and they should be if they follow the CF and ACDD conventions) this is not neccessarily the case.</p>
<p>In this notebook we will look at how to combine data from multiple netcdf files into a single object (e.g. dataframe, multi-dimensional array) that you can use.</p>
<section id="introducing-the-data">
<h2>Introducing the data<a class="headerlink" href="#introducing-the-data" title="Permalink to this heading">#</a></h2>
<p>The link below is an OPeNDAP access point to CTD data collected as part of the Nansen Legacy data. The data are grouped together by cruise and each CF-NetCDF file contains data from a single depth profile.
<a class="reference external" href="https://opendap1.nodc.no/opendap/physics/point/cruise/nansen_legacy-single_profile/">https://opendap1.nodc.no/opendap/physics/point/cruise/nansen_legacy-single_profile/</a></p>
<p>Each file has it’s own access point like this
<a class="reference external" href="https://opendap1.nodc.no/opendap/physics/point/cruise/nansen_legacy-single_profile/NMDC_Nansen-Legacy_PR_CT_58US_2021708/CTD_station_ISG_SVR1_-">https://opendap1.nodc.no/opendap/physics/point/cruise/nansen_legacy-single_profile/NMDC_Nansen-Legacy_PR_CT_58US_2021708/CTD_station_ISG_SVR1_-</a><em>Nansen_Legacy_Cruise</em>-_2021_Joint_Cruise_2-1.nc.html</p>
<p>And anyone can download some or all of the data from the CF-NetCDF file into ASCII files. This makes data access a lot easier for people who don’t yet know how to work with NetCDF files.</p>
<p>We can load into Python by removing the <em>.html</em> suffix and including the rest of the URL as our filepath. You don’t have to download the data!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="n">xrds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;https://opendap1.nodc.no/opendap/physics/point/cruise/nansen_legacy-single_profile/NMDC_Nansen-Legacy_PR_CT_58US_2021708/CTD_station_ISG_SVR1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;</span><span class="p">)</span>
<span class="n">xrds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:        (PRES: 259)
Coordinates:
  * PRES           (PRES) float32 2.0 3.0 4.0 5.0 ... 257.0 258.0 259.0 260.0
Data variables: (12/33)
    PRES_QC        (PRES) float32 ...
    TEMP           (PRES) float32 ...
    PSAL           (PRES) float32 ...
    FLU2           (PRES) float32 ...
    CNDC           (PRES) float32 ...
    DENS           (PRES) float32 ...
    ...             ...
    OXYOCPVL-1_QC  (PRES) float32 ...
    SPAR_QC        (PRES) float32 ...
    PAR_QC         (PRES) float32 ...
    PSAL-2_QC      (PRES) float32 ...
    TEMP-2_QC      (PRES) float32 ...
    ATTNZS01_QC    (PRES) float32 ...
Attributes: (12/73)
    qc_manual:                       Recommendations for in-situ data Near Re...
    contact:                         datahjelp@hi.no
    distribution_statement:          These data are public and free of charge...
    naming_authority:                no.unis
    license:                         https://creativecommons.org/licenses/by/...
    data_assembly_center:            IMR
    ...                              ...
    geospatial_vertical_resolution:  1 dbar
    pi_email:                        jannes@unis.no
    pi_institution:                  University Centre in Svalbard
    station_name:                    ISG/SVR1
    metadata_link:                   https://doi.org/10.21335/NMDC-2085836005...
    _NCProperties:                   version=2,netcdf=4.6.3,hdf5=1.10.5</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-8c9797cd-0da8-47a3-ba35-ff97144bb862' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8c9797cd-0da8-47a3-ba35-ff97144bb862' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>PRES</span>: 259</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-81f95c18-6ed2-44cf-96d6-af4efcb3b4d9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-81f95c18-6ed2-44cf-96d6-af4efcb3b4d9' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>PRES</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>2.0 3.0 4.0 ... 258.0 259.0 260.0</div><input id='attrs-59c8d579-b31b-48ff-8ca6-d686dbfe10b8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-59c8d579-b31b-48ff-8ca6-d686dbfe10b8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d9e375a3-2950-4c6e-b182-4902335f4b8a' class='xr-var-data-in' type='checkbox'><label for='data-d9e375a3-2950-4c6e-b182-4902335f4b8a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Z</dd><dt><span>uncertainty :</span></dt><dd> </dd><dt><span>comment :</span></dt><dd> </dd><dt><span>ancillary_variables :</span></dt><dd>PRES_QC</dd><dt><span>standard_name :</span></dt><dd>sea_water_pressure</dd><dt><span>long_name :</span></dt><dd>Sea pressure</dd><dt><span>units :</span></dt><dd>dbar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>data_mode :</span></dt><dd>D</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>array([  2.,   3.,   4., ..., 258., 259., 260.], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ce856d16-55ab-4ed7-98a7-056bad533f1b' class='xr-section-summary-in' type='checkbox'  ><label for='section-ce856d16-55ab-4ed7-98a7-056bad533f1b' class='xr-section-summary' >Data variables: <span>(33)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>PRES_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-fa657fd2-aad0-482e-8689-2eb01f876b99' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fa657fd2-aad0-482e-8689-2eb01f876b99' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5fca53a3-18fc-471d-9279-a971f027e572' class='xr-var-data-in' type='checkbox'><label for='data-5fca53a3-18fc-471d-9279-a971f027e572' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Sea pressure quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>TEMP</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-075ff568-3f25-4d25-8a02-fb4e83e34dc9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-075ff568-3f25-4d25-8a02-fb4e83e34dc9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0071e85a-ad01-4d62-8d9e-4e6db62e79f9' class='xr-var-data-in' type='checkbox'><label for='data-0071e85a-ad01-4d62-8d9e-4e6db62e79f9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_temperature</dd><dt><span>long_name :</span></dt><dd>Sea temperature</dd><dt><span>units :</span></dt><dd>degrees_C</dd><dt><span>valid_min :</span></dt><dd>-2.5</dd><dt><span>valid_max :</span></dt><dd>40.0</dd><dt><span>ancillary_variables :</span></dt><dd>TEMP_QC </dd><dt><span>data_mode :</span></dt><dd>D</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>PSAL</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-eb0158c8-c82f-4f0a-8b15-692041244fe9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-eb0158c8-c82f-4f0a-8b15-692041244fe9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-54ce53c0-be6f-413a-9ae4-2e54fcb4ef63' class='xr-var-data-in' type='checkbox'><label for='data-54ce53c0-be6f-413a-9ae4-2e54fcb4ef63' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_practical_salinity</dd><dt><span>long_name :</span></dt><dd>Practical salinity</dd><dt><span>units :</span></dt><dd>0.001</dd><dt><span>valid_min :</span></dt><dd>2.0</dd><dt><span>valid_max :</span></dt><dd>41.0</dd><dt><span>ancillary_variables :</span></dt><dd>PSAL_QC </dd><dt><span>data_mode :</span></dt><dd>D</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>FLU2</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-1cbbd7da-ee15-4b01-993a-c97a016fdf86' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1cbbd7da-ee15-4b01-993a-c97a016fdf86' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7b66e51e-fe32-4485-8b76-cd47694fb477' class='xr-var-data-in' type='checkbox'><label for='data-7b66e51e-fe32-4485-8b76-cd47694fb477' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>mass_concentration_of_chlorophyll_a_in_sea_water</dd><dt><span>long_name :</span></dt><dd>Chlorophyll-a fluorescence</dd><dt><span>units :</span></dt><dd>mg m-3</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>100.0</dd><dt><span>ancillary_variables :</span></dt><dd>FLU2_QC </dd><dt><span>data_mode :</span></dt><dd>R</dd><dt><span>comment :</span></dt><dd>Fluorescence, WET Labs ECO-AFL/FL [mg/m^3]</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CNDC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a5111792-0f1c-4844-bd61-185470669099' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a5111792-0f1c-4844-bd61-185470669099' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-54b21514-3e51-4739-a908-d357aa2f81eb' class='xr-var-data-in' type='checkbox'><label for='data-54b21514-3e51-4739-a908-d357aa2f81eb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_electrical_conductivity</dd><dt><span>long_name :</span></dt><dd>Electrical conductivity</dd><dt><span>units :</span></dt><dd>S m-1</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>50.0</dd><dt><span>ancillary_variables :</span></dt><dd>CNDC_QC </dd><dt><span>data_mode :</span></dt><dd>D</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DENS</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-1c83d2b7-9196-49a7-ba6a-fff716932f68' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1c83d2b7-9196-49a7-ba6a-fff716932f68' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-30e68fbc-4a1c-49a0-b11e-6b827d204b18' class='xr-var-data-in' type='checkbox'><label for='data-30e68fbc-4a1c-49a0-b11e-6b827d204b18' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_sigma_theta</dd><dt><span>long_name :</span></dt><dd>Sea density (sigma-theta)</dd><dt><span>units :</span></dt><dd>kg m-3</dd><dt><span>valid_min :</span></dt><dd>20.0</dd><dt><span>valid_max :</span></dt><dd>40.0</dd><dt><span>ancillary_variables :</span></dt><dd>DENS_QC </dd><dt><span>data_mode :</span></dt><dd>R</dd><dt><span>comment :</span></dt><dd>density, sigma-theta [kg/m^3]</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SVEL</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-461d552d-02c5-47f6-815b-737e04bc6925' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-461d552d-02c5-47f6-815b-737e04bc6925' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-83c3c49a-8fe2-4004-8697-8388864158aa' class='xr-var-data-in' type='checkbox'><label for='data-83c3c49a-8fe2-4004-8697-8388864158aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>speed_of_sound_in_sea_water</dd><dt><span>long_name :</span></dt><dd>Sound velocity</dd><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>1000.0</dd><dt><span>ancillary_variables :</span></dt><dd>SVEL_QC </dd><dt><span>data_mode :</span></dt><dd>R</dd><dt><span>comment :</span></dt><dd>Sound Velocity [Chen-Millero, m/s]</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CCOMD003</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d64867ab-6538-49d2-84ba-87a70f482022' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d64867ab-6538-49d2-84ba-87a70f482022' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d751273a-7e1f-42f8-8f23-eee62ed5d1b0' class='xr-var-data-in' type='checkbox'><label for='data-d751273a-7e1f-42f8-8f23-eee62ed5d1b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>concentration_of_colored_dissolved_organic_matter_in_sea_water_expressed_as_equivalent_mass_fraction_of_quinine_sulfate_dihydrate</dd><dt><span>long_name :</span></dt><dd>CDOM Gelbstoff per unit volume of the water body by in-situ fluorometer</dd><dt><span>units :</span></dt><dd>mg m-3</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>100.0</dd><dt><span>ancillary_variables :</span></dt><dd>CCOMD003_QC </dd><dt><span>data_mode :</span></dt><dd>R</dd><dt><span>comment :</span></dt><dd>Fluorescence, WET Labs CDOM [mg/m^3]</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DOX1-1</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-56cf3434-70e7-4cec-96b0-62b4604d298a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-56cf3434-70e7-4cec-96b0-62b4604d298a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-90a95353-e0f3-4d9e-bdc8-1951e334160a' class='xr-var-data-in' type='checkbox'><label for='data-90a95353-e0f3-4d9e-bdc8-1951e334160a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>volume_fraction_of_oxygen_in_sea_water</dd><dt><span>long_name :</span></dt><dd>Dissolved oxygen</dd><dt><span>units :</span></dt><dd>ml l-1</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>1000.0</dd><dt><span>ancillary_variables :</span></dt><dd>DOX1-1_QC </dd><dt><span>data_mode :</span></dt><dd>R</dd><dt><span>comment :</span></dt><dd>Oxygen, SBE 43 [ml/l], WS = 2</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DOX2-1</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d68c857a-7094-4853-af84-63bdce241ea9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d68c857a-7094-4853-af84-63bdce241ea9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5cf541f5-dcd2-4412-b8eb-78e8cada353b' class='xr-var-data-in' type='checkbox'><label for='data-5cf541f5-dcd2-4412-b8eb-78e8cada353b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>moles_of_oxygen_per_unit_mass_in_sea_water</dd><dt><span>long_name :</span></dt><dd>Dissolved oxygen</dd><dt><span>units :</span></dt><dd>\302\265mol kg-1</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>1000.0</dd><dt><span>ancillary_variables :</span></dt><dd>DOX2-1_QC </dd><dt><span>data_mode :</span></dt><dd>R</dd><dt><span>comment :</span></dt><dd>Sbox0Mm/Kg</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CNDC-2</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-1451e0cf-a861-452d-8b33-3cfe32d1a3a2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1451e0cf-a861-452d-8b33-3cfe32d1a3a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a45a25aa-048a-4939-961c-20e147d57cc0' class='xr-var-data-in' type='checkbox'><label for='data-a45a25aa-048a-4939-961c-20e147d57cc0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_electrical_conductivity</dd><dt><span>long_name :</span></dt><dd>Electrical conductivity</dd><dt><span>units :</span></dt><dd>S m-1</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>50.0</dd><dt><span>ancillary_variables :</span></dt><dd>CNDC-2_QC </dd><dt><span>data_mode :</span></dt><dd>R</dd><dt><span>comment :</span></dt><dd>Conductivity, 2 [S/m]</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>OXYOCPVL-1</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-72a663c6-47c3-4031-9f2b-0168e1438887' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-72a663c6-47c3-4031-9f2b-0168e1438887' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dbe90948-73b7-4bb5-8916-d3d98ad9aaa5' class='xr-var-data-in' type='checkbox'><label for='data-dbe90948-73b7-4bb5-8916-d3d98ad9aaa5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>&#x27;\342\200\231</dd><dt><span>long_name :</span></dt><dd>Raw signal (voltage) of instrument output by oxygen senso</dd><dt><span>units :</span></dt><dd>V</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>1000.0</dd><dt><span>ancillary_variables :</span></dt><dd>OXYOCPVL-1_QC </dd><dt><span>data_mode :</span></dt><dd>R</dd><dt><span>comment :</span></dt><dd>Oxygen Voltage, SBE 43</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPAR</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-0a149d61-7300-4692-bdac-5f761f8ae827' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0a149d61-7300-4692-bdac-5f761f8ae827' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-95ac23d4-da5f-4d3b-a869-0b643e8eb295' class='xr-var-data-in' type='checkbox'><label for='data-95ac23d4-da5f-4d3b-a869-0b643e8eb295' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>&#x27;\342\200\231</dd><dt><span>long_name :</span></dt><dd>Photosynthetically active radiation</dd><dt><span>units :</span></dt><dd>\316\274mol m-2 s-1</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>10000.0</dd><dt><span>ancillary_variables :</span></dt><dd>SPAR_QC </dd><dt><span>data_mode :</span></dt><dd>R</dd><dt><span>comment :</span></dt><dd>SPAR/Surface Irradiance</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>PAR</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-c91fb350-f743-4cf6-8001-ca12a5805295' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c91fb350-f743-4cf6-8001-ca12a5805295' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-510ad967-0dcc-49f4-bc62-5e78f52dbf88' class='xr-var-data-in' type='checkbox'><label for='data-510ad967-0dcc-49f4-bc62-5e78f52dbf88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>&#x27;\342\200\231</dd><dt><span>long_name :</span></dt><dd>Photosynthetically active radiation</dd><dt><span>units :</span></dt><dd>\316\274mol m-2 s-1</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>10000.0</dd><dt><span>ancillary_variables :</span></dt><dd>PAR_QC </dd><dt><span>data_mode :</span></dt><dd>R</dd><dt><span>comment :</span></dt><dd>PAR/Irradiance, Biospherical/Licor</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>PSAL-2</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-154285b5-d1c4-4937-a38c-a725ed1f3dc7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-154285b5-d1c4-4937-a38c-a725ed1f3dc7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6cf0a4e3-22fa-4737-ace5-19d0cde5a523' class='xr-var-data-in' type='checkbox'><label for='data-6cf0a4e3-22fa-4737-ace5-19d0cde5a523' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_practical_salinity</dd><dt><span>long_name :</span></dt><dd>Practical salinity</dd><dt><span>units :</span></dt><dd>0.001</dd><dt><span>valid_min :</span></dt><dd>2.0</dd><dt><span>valid_max :</span></dt><dd>40.0</dd><dt><span>ancillary_variables :</span></dt><dd>PSAL-2_QC </dd><dt><span>data_mode :</span></dt><dd>R</dd><dt><span>comment :</span></dt><dd>Salinity, 2 [PSU]</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>TEMP-2</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f11badb9-4551-47de-8d1f-517ad6bfa51b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f11badb9-4551-47de-8d1f-517ad6bfa51b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7cbe2952-83db-42a2-9821-4f309869acab' class='xr-var-data-in' type='checkbox'><label for='data-7cbe2952-83db-42a2-9821-4f309869acab' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_temperature</dd><dt><span>long_name :</span></dt><dd>Sea temperature</dd><dt><span>units :</span></dt><dd>degrees_C</dd><dt><span>valid_min :</span></dt><dd>-2.5</dd><dt><span>valid_max :</span></dt><dd>40.0</dd><dt><span>ancillary_variables :</span></dt><dd>TEMP-2_QC </dd><dt><span>data_mode :</span></dt><dd>R</dd><dt><span>comment :</span></dt><dd>Temperature, 2 [ITS-68, deg C]</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ATTNZS01</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a207dc84-a2ff-4e94-8a8f-67878a70dd0d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a207dc84-a2ff-4e94-8a8f-67878a70dd0d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-75b82d4d-9d03-40e9-953b-8018f02f51c3' class='xr-var-data-in' type='checkbox'><label for='data-75b82d4d-9d03-40e9-953b-8018f02f51c3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>&#x27;\342\200\231</dd><dt><span>long_name :</span></dt><dd>WET Labs transmissometer calibrated to zero in clear water</dd><dt><span>units :</span></dt><dd>%</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>100.0</dd><dt><span>ancillary_variables :</span></dt><dd>ATTNZS01_QC </dd><dt><span>data_mode :</span></dt><dd>R</dd><dt><span>comment :</span></dt><dd>Beam Transmission, WET Labs C-Star [%]</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>TEMP_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-6cb2f6a3-6945-4272-97f2-a18e08c6723e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6cb2f6a3-6945-4272-97f2-a18e08c6723e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fe9efec3-c068-4de3-8498-af400760e8b6' class='xr-var-data-in' type='checkbox'><label for='data-fe9efec3-c068-4de3-8498-af400760e8b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Sea temperature quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>PSAL_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-fd035dcf-b8f1-4e6b-bb46-ce3ed734f1a2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fd035dcf-b8f1-4e6b-bb46-ce3ed734f1a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-45be0458-52f2-4818-97a8-7e9193acc697' class='xr-var-data-in' type='checkbox'><label for='data-45be0458-52f2-4818-97a8-7e9193acc697' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Practical salinity quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>FLU2_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-c6ca74ca-2864-4f2d-8496-3341c4378baa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c6ca74ca-2864-4f2d-8496-3341c4378baa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-85db930e-006b-4942-afa6-1cfe70504682' class='xr-var-data-in' type='checkbox'><label for='data-85db930e-006b-4942-afa6-1cfe70504682' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Chlorophyll-a fluorescence quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CNDC_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-742961ea-3c93-4e92-8b28-1488af885432' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-742961ea-3c93-4e92-8b28-1488af885432' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c778eb9d-9517-46c3-95c7-acd908353dc1' class='xr-var-data-in' type='checkbox'><label for='data-c778eb9d-9517-46c3-95c7-acd908353dc1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Electrical conductivity quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DENS_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-b251e5d4-c30f-4190-8ee0-15cd4e31cd93' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b251e5d4-c30f-4190-8ee0-15cd4e31cd93' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f2bf2480-9b7b-4405-92d0-c4b7ab25a32a' class='xr-var-data-in' type='checkbox'><label for='data-f2bf2480-9b7b-4405-92d0-c4b7ab25a32a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Sea density (sigma-theta) quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SVEL_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-bc38dde2-7769-4452-a7d7-3c69e3c4c251' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bc38dde2-7769-4452-a7d7-3c69e3c4c251' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d8fa7636-29cd-4058-9fb7-b6ec1a497ba2' class='xr-var-data-in' type='checkbox'><label for='data-d8fa7636-29cd-4058-9fb7-b6ec1a497ba2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Sound velocity quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CCOMD003_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5d32ecea-f49f-402e-ac03-9dee292fed94' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5d32ecea-f49f-402e-ac03-9dee292fed94' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-80552c20-1ab4-46ca-9fc8-dcc85af6e54c' class='xr-var-data-in' type='checkbox'><label for='data-80552c20-1ab4-46ca-9fc8-dcc85af6e54c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>CDOM Gelbstoff per unit volume of the water body by in-situ fluorometer quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DOX1-1_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d72f0158-843f-400c-a68f-0335c2ae3640' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d72f0158-843f-400c-a68f-0335c2ae3640' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c3b9bc83-b986-4a93-b73e-a59e3694f84b' class='xr-var-data-in' type='checkbox'><label for='data-c3b9bc83-b986-4a93-b73e-a59e3694f84b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Dissolved oxygen quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DOX2-1_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5444be8d-1b22-49fa-87d6-7360d7ed9804' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5444be8d-1b22-49fa-87d6-7360d7ed9804' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-84753a92-1205-4233-8922-742cb87be304' class='xr-var-data-in' type='checkbox'><label for='data-84753a92-1205-4233-8922-742cb87be304' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Dissolved oxygen quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CNDC-2_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-c6f321ef-91e6-45d2-ac1a-b7abbdda7261' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c6f321ef-91e6-45d2-ac1a-b7abbdda7261' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0807442a-6b0f-4554-862b-468e63c5fb69' class='xr-var-data-in' type='checkbox'><label for='data-0807442a-6b0f-4554-862b-468e63c5fb69' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Electrical conductivity quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>OXYOCPVL-1_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-cfe74257-44e6-4484-b794-bcf48790d4ce' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cfe74257-44e6-4484-b794-bcf48790d4ce' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d34587ff-e2c9-4323-a408-3fe577b98f8d' class='xr-var-data-in' type='checkbox'><label for='data-d34587ff-e2c9-4323-a408-3fe577b98f8d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Raw signal (voltage) of instrument output by oxygen senso quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPAR_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-8d5a5d42-140d-45d6-bc50-f06d175c8a20' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8d5a5d42-140d-45d6-bc50-f06d175c8a20' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5fa75735-fead-426a-9ad2-ca082192c905' class='xr-var-data-in' type='checkbox'><label for='data-5fa75735-fead-426a-9ad2-ca082192c905' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Photosynthetically active radiation quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>PAR_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-c514a6fe-5c5b-404e-b6ec-5cd1c1e4512f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c514a6fe-5c5b-404e-b6ec-5cd1c1e4512f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-443ee721-5c06-44f4-b16c-4d5d0b1bba9c' class='xr-var-data-in' type='checkbox'><label for='data-443ee721-5c06-44f4-b16c-4d5d0b1bba9c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Photosynthetically active radiation quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>PSAL-2_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-efa78935-0528-411a-864b-58f0f5e397cc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-efa78935-0528-411a-864b-58f0f5e397cc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-601e6cad-8d0a-4eec-835d-028c0945e0c2' class='xr-var-data-in' type='checkbox'><label for='data-601e6cad-8d0a-4eec-835d-028c0945e0c2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Practical salinity quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>TEMP-2_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-3af8747d-a49d-437b-8fa0-647dc3be4bce' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3af8747d-a49d-437b-8fa0-647dc3be4bce' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f610dde8-9c6b-4006-a2d5-d80215074d2e' class='xr-var-data-in' type='checkbox'><label for='data-f610dde8-9c6b-4006-a2d5-d80215074d2e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>Sea temperature quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ATTNZS01_QC</span></div><div class='xr-var-dims'>(PRES)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4022afa8-51a9-4584-a73a-9e2c130a6e8d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4022afa8-51a9-4584-a73a-9e2c130a6e8d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f96c4e36-3cff-4f25-8b90-fb006ceee61b' class='xr-var-data-in' type='checkbox'><label for='data-f96c4e36-3cff-4f25-8b90-fb006ceee61b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>conventions :</span></dt><dd>Copernicus Marine In Situ reference table 2</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>9</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 8 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_qc_performed good_data probably_good_data bad_data_that_are_potentially_correctable bad_data value_changed value_below_detection nominal_value interpolated_value missing_value</dd><dt><span>long_name :</span></dt><dd>WET Labs transmissometer calibrated to zero in clear water quality flag</dd></dl></div><div class='xr-var-data'><pre>[259 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-30be56b6-8cd7-4ae2-bd80-496d74fe1dc2' class='xr-section-summary-in' type='checkbox'  ><label for='section-30be56b6-8cd7-4ae2-bd80-496d74fe1dc2' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>PRES</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-272adf7c-d04e-45eb-b143-4c82e65834b4' class='xr-index-data-in' type='checkbox'/><label for='index-272adf7c-d04e-45eb-b143-4c82e65834b4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,  10.0,  11.0,
       ...
       251.0, 252.0, 253.0, 254.0, 255.0, 256.0, 257.0, 258.0, 259.0, 260.0],
      dtype=&#x27;float32&#x27;, name=&#x27;PRES&#x27;, length=259))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2d730335-e2de-40f0-8e07-6cf64f48f2a0' class='xr-section-summary-in' type='checkbox'  ><label for='section-2d730335-e2de-40f0-8e07-6cf64f48f2a0' class='xr-section-summary' >Attributes: <span>(73)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>qc_manual :</span></dt><dd>Recommendations for in-situ data Near Real Time Quality Control https://doi.org/10.13155/36230</dd><dt><span>contact :</span></dt><dd>datahjelp@hi.no</dd><dt><span>distribution_statement :</span></dt><dd>These data are public and free of charge. User assumes all risk for use of data. User must display citation in any publication or product using data. User must contact PI prior to any commercial use of data.</dd><dt><span>naming_authority :</span></dt><dd>no.unis</dd><dt><span>license :</span></dt><dd>https://creativecommons.org/licenses/by/4.0/ https://creativecommons.org/licenses/by/4.0/</dd><dt><span>data_assembly_center :</span></dt><dd>IMR</dd><dt><span>update_interval :</span></dt><dd>void</dd><dt><span>area :</span></dt><dd>Arctic Ocean</dd><dt><span>author :</span></dt><dd></dd><dt><span>Conventions :</span></dt><dd>CF-1.8, ACDD-1.3, OceanSITES Manual 1.4</dd><dt><span>data_mode :</span></dt><dd>M</dd><dt><span>comment :</span></dt><dd>Descending CTD profile</dd><dt><span>history :</span></dt><dd>Created at 2022-08-08T12:43:51Z using the xarray library in Python</dd><dt><span>netcdf_version :</span></dt><dd>netCDF-4 classic model</dd><dt><span>quality_index :</span></dt><dd>A</dd><dt><span>quality_control_indicator :</span></dt><dd>0</dd><dt><span>publisher_name :</span></dt><dd>Elisabeth Jones</dd><dt><span>publisher_email :</span></dt><dd>datahjelp@imr.no</dd><dt><span>wmo_platform_code :</span></dt><dd></dd><dt><span>ices_platform_code :</span></dt><dd></dd><dt><span>site_code :</span></dt><dd></dd><dt><span>bottom_depth :</span></dt><dd></dd><dt><span>wmo_inst_type :</span></dt><dd></dd><dt><span>geospatial_vertical_positive :</span></dt><dd>down</dd><dt><span>platform_code :</span></dt><dd>58US</dd><dt><span>platform_name :</span></dt><dd>Kronprins Haakon</dd><dt><span>source :</span></dt><dd>research vessel</dd><dt><span>institution_country :</span></dt><dd>Norway</dd><dt><span>source_platform_category_code :</span></dt><dd>31</dd><dt><span>data_type :</span></dt><dd>OceanSITES vertical profile</dd><dt><span>cdm_data_type :</span></dt><dd>PROFILE</dd><dt><span>instrument :</span></dt><dd>CTD Seabird</dd><dt><span>keywords :</span></dt><dd>EARTH SCIENCE &gt; OCEANS &gt; OCEAN OPTICS &gt; FLUORESCENCE, EARTH SCIENCE &gt; OCEANS &gt; SALINITY/DENSITY &gt; DENSITY, EARTH SCIENCE &gt; OCEANS &gt; SALINITY/DENSITY &gt; OCEAN SALINITY, EARTH SCIENCE &gt; OCEANS &gt; OCEAN ACOUSTICS &gt; ACOUSTIC VELOCITY, EARTH SCIENCE &gt; OCEANS &gt; OCEAN TEMPERATURE &gt; WATER TEMPERATURE, EARTH SCIENCE &gt; OCEANS &gt; SALINITY/DENSITY &gt; CONDUCTIVITY</dd><dt><span>keywords_vocabulary :</span></dt><dd>GCMD:GCMD Keywords</dd><dt><span>id :</span></dt><dd>NMDC_Nansen-Legacy_PR_CT_58US_2021708_ISG/SVR1</dd><dt><span>time_coverage_start :</span></dt><dd>2021-07-12T19:05:04Z</dd><dt><span>time_coverage_end :</span></dt><dd>2021-07-12T19:05:04Z</dd><dt><span>date_update :</span></dt><dd>2022-08-08T12:43:51Z</dd><dt><span>date_created :</span></dt><dd>2022-08-08T12:43:51Z</dd><dt><span>geospatial_lat_min :</span></dt><dd>78.1282</dd><dt><span>geospatial_lat_max :</span></dt><dd>78.1282</dd><dt><span>geospatial_lon_min :</span></dt><dd>14.0032</dd><dt><span>geospatial_lon_max :</span></dt><dd>14.0032</dd><dt><span>geospatial_vertical_min :</span></dt><dd>2.0</dd><dt><span>geospatial_vertical_max :</span></dt><dd>261.0</dd><dt><span>citation :</span></dt><dd>These data were collected and made freely available by the Nansen Legacy project and the programs that contribute to it.</dd><dt><span>project :</span></dt><dd>The Nansen Legacy Project (RCN # 276730)</dd><dt><span>references :</span></dt><dd>https://doi.org/10.21335/NMDC-2085836005</dd><dt><span>featureType :</span></dt><dd>Profile</dd><dt><span>summary :</span></dt><dd>The Joint Cruise 2-1 addressed objectives of the work packages Physical drivers (Research Foci 1), Human impact (Research Foci 2) and The living Barents Sea (Research Foci 3) along the Nansen Legacy transect in open water and within the sea ice. The cruise focussed on comparing the state of the physical, chemical and biological conditions in the southern and northern parts of the study area. These data are created from the CTD data published by NMDC for the whole cruise (https://doi.org/10.21335/NMDC-2085836005). The values have not be changed.</dd><dt><span>doi :</span></dt><dd>10.21335/NMDC-2085836005-ISG_SVR1</dd><dt><span>pi_name :</span></dt><dd>Janne Søreide</dd><dt><span>institution :</span></dt><dd>Institute of Marine Research</dd><dt><span>institution_edmo_code :</span></dt><dd>1351</dd><dt><span>institution_references :</span></dt><dd>https://www.hi.no/hi</dd><dt><span>title :</span></dt><dd>CTD_station_ISG_SVR1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1</dd><dt><span>creator_institution :</span></dt><dd>Institute of Marine Research</dd><dt><span>creator_name :</span></dt><dd>Elisabeth Jones</dd><dt><span>creator_type :</span></dt><dd>person</dd><dt><span>creator_email :</span></dt><dd>datahjelp@imr.no</dd><dt><span>creator_url :</span></dt><dd>https://www.hi.no/hi</dd><dt><span>publisher :</span></dt><dd>The Norwegian Marine Data Centre (NMD)</dd><dt><span>publisher_url :</span></dt><dd>https://www.hi.no/hi</dd><dt><span>acknowledgement :</span></dt><dd>The Nansen Legacy project is funded by the Research Council of Norway (RCN # 276730). These data are created from the CTD data published by NMDC for the whole cruise (10.21335/NMDC-2085836005). The values have not be changed. For information about this process, please contact Luke Marsden at data.nleg@unis.no</dd><dt><span>cruiseNumber :</span></dt><dd>2021708</dd><dt><span>cruiseName :</span></dt><dd>2021 Joint Cruise 2-1</dd><dt><span>geospatial_vertical_units :</span></dt><dd>dbar</dd><dt><span>geospatial_vertical_resolution :</span></dt><dd>1 dbar</dd><dt><span>pi_email :</span></dt><dd>jannes@unis.no</dd><dt><span>pi_institution :</span></dt><dd>University Centre in Svalbard</dd><dt><span>station_name :</span></dt><dd>ISG/SVR1</dd><dt><span>metadata_link :</span></dt><dd>https://doi.org/10.21335/NMDC-2085836005-ISG_SVR1</dd><dt><span>_NCProperties :</span></dt><dd>version=2,netcdf=4.6.3,hdf5=1.10.5</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Let’s look at a quick example of how we can extract the data into numpy arrays</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="n">xrds</span><span class="p">[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">salinity</span> <span class="o">=</span> <span class="n">xrds</span><span class="p">[</span><span class="s1">&#39;PSAL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">temperature</span><span class="p">,</span> <span class="n">salinity</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([3.226, 3.211, 3.202, 3.205, 3.213, 3.215, 3.21 , 3.215, 3.191,
        3.162, 3.144, 3.118, 3.081, 2.993, 2.913, 2.861, 2.837, 2.826,
        2.809, 2.776, 2.743, 2.703, 2.687, 2.652, 2.587, 2.544, 2.508,
        2.483, 2.472, 2.434, 2.399, 2.355, 2.298, 2.277, 2.252, 2.225,
        2.201, 2.173, 2.113, 2.073, 2.06 , 2.04 , 2.022, 2.006, 2.004,
        2.008, 2.067, 2.126, 2.145, 2.143, 2.248, 2.288, 2.232, 2.212,
        2.136, 1.997, 1.748, 1.594, 1.657, 1.623, 1.468, 1.385, 1.374,
        1.383, 1.378, 1.38 , 1.367, 1.351, 1.38 , 1.376, 1.391, 1.396,
        1.403, 1.398, 1.413, 1.393, 1.371, 1.248, 1.159, 1.063, 0.997,
        0.981, 0.944, 0.933, 0.928, 0.964, 1.   , 1.013, 1.044, 1.095,
        1.241, 1.216, 1.154, 1.281, 1.362, 1.4  , 1.378, 1.353, 1.237,
        1.069, 0.993, 0.989, 1.048, 1.078, 1.07 , 1.05 , 1.016, 0.946,
        0.928, 0.984, 1.004, 0.942, 0.892, 0.828, 0.691, 0.641, 0.635,
        0.632, 0.625, 0.615, 0.566, 0.542, 0.518, 0.493, 0.52 , 0.457,
        0.426, 0.416, 0.407, 0.4  , 0.388, 0.389, 0.387, 0.387, 0.373,
        0.368, 0.363, 0.362, 0.36 , 0.359, 0.361, 0.373, 0.395, 0.425,
        0.443, 0.446, 0.449, 0.449, 0.45 , 0.45 , 0.448, 0.455, 0.454,
        0.464, 0.485, 0.63 , 0.753, 0.873, 0.84 , 0.793, 0.754, 0.764,
        0.741, 0.544, 0.496, 0.413, 0.337, 0.341, 0.346, 0.378, 0.435,
        0.468, 0.514, 0.554, 0.484, 0.42 , 0.447, 0.554, 0.639, 0.747,
        0.991, 1.174, 1.382, 1.472, 1.527, 1.52 , 1.521, 1.523, 1.626,
        1.694, 1.718, 1.778, 1.815, 1.937, 2.004, 2.018, 2.126, 2.203,
        2.284, 2.384, 2.454, 2.49 , 2.514, 2.506, 2.464, 2.436, 2.413,
        2.368, 2.369, 2.534, 2.579, 2.572, 2.583, 2.598, 2.618, 2.629,
        2.648, 2.669, 2.676, 2.682, 2.657, 2.641, 2.576, 2.503, 2.447,
        2.428, 2.447, 2.501, 2.546, 2.574, 2.743, 2.776, 2.754, 2.794,
        2.799, 2.8  , 2.802, 2.806, 2.805, 2.805, 2.788, 2.754, 2.762,
        2.779, 2.786, 2.792, 2.792, 2.793, 2.728, 2.486, 2.424, 2.386,
        2.353, 2.304, 2.302, 2.268, 2.221, 2.206, 2.189], dtype=float32),
 array([34.233, 34.24 , 34.243, 34.24 , 34.239, 34.241, 34.248, 34.246,
        34.251, 34.254, 34.255, 34.262, 34.265, 34.271, 34.274, 34.276,
        34.277, 34.279, 34.282, 34.284, 34.287, 34.289, 34.29 , 34.293,
        34.297, 34.302, 34.305, 34.311, 34.315, 34.319, 34.321, 34.321,
        34.321, 34.325, 34.329, 34.33 , 34.33 , 34.328, 34.334, 34.341,
        34.343, 34.344, 34.346, 34.35 , 34.353, 34.358, 34.369, 34.378,
        34.379, 34.38 , 34.398, 34.413, 34.415, 34.415, 34.411, 34.401,
        34.385, 34.383, 34.386, 34.387, 34.389, 34.399, 34.403, 34.404,
        34.419, 34.42 , 34.42 , 34.419, 34.422, 34.421, 34.422, 34.422,
        34.423, 34.422, 34.424, 34.426, 34.429, 34.431, 34.43 , 34.427,
        34.425, 34.425, 34.425, 34.425, 34.428, 34.433, 34.437, 34.441,
        34.447, 34.453, 34.474, 34.475, 34.474, 34.488, 34.499, 34.507,
        34.506, 34.504, 34.497, 34.486, 34.48 , 34.481, 34.488, 34.494,
        34.495, 34.5  , 34.503, 34.501, 34.503, 34.512, 34.518, 34.516,
        34.514, 34.511, 34.505, 34.502, 34.501, 34.502, 34.502, 34.502,
        34.502, 34.501, 34.5  , 34.5  , 34.504, 34.502, 34.501, 34.501,
        34.502, 34.502, 34.503, 34.505, 34.506, 34.508, 34.511, 34.512,
        34.513, 34.514, 34.515, 34.518, 34.519, 34.521, 34.526, 34.532,
        34.536, 34.537, 34.537, 34.537, 34.538, 34.538, 34.538, 34.538,
        34.539, 34.54 , 34.543, 34.56 , 34.573, 34.587, 34.587, 34.584,
        34.58 , 34.58 , 34.578, 34.563, 34.558, 34.553, 34.548, 34.548,
        34.55 , 34.558, 34.569, 34.572, 34.578, 34.584, 34.58 , 34.574,
        34.577, 34.588, 34.597, 34.608, 34.633, 34.653, 34.677, 34.688,
        34.695, 34.694, 34.693, 34.692, 34.705, 34.714, 34.718, 34.725,
        34.729, 34.743, 34.752, 34.754, 34.768, 34.778, 34.787, 34.8  ,
        34.809, 34.814, 34.818, 34.818, 34.814, 34.81 , 34.808, 34.803,
        34.804, 34.825, 34.832, 34.832, 34.833, 34.836, 34.838, 34.839,
        34.842, 34.845, 34.846, 34.847, 34.846, 34.844, 34.838, 34.831,
        34.825, 34.823, 34.824, 34.831, 34.838, 34.842, 34.864, 34.869,
        34.867, 34.872, 34.873, 34.873, 34.873, 34.873, 34.873, 34.873,
        34.871, 34.867, 34.868, 34.87 , 34.871, 34.871, 34.871, 34.872,
        34.866, 34.84 , 34.833, 34.834, 34.827, 34.824, 34.821, 34.821,
        34.816, 34.813, 34.812], dtype=float32))
</pre></div>
</div>
</div>
</div>
<p>Or into a pandas dataframe that we can export as a CSV or XLSX file for example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">xrds</span><span class="p">[[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">,</span><span class="s1">&#39;PSAL&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="c1">#df.to_csv(&#39;/path/to/file.csv&#39;)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TEMP</th>
      <th>PSAL</th>
    </tr>
    <tr>
      <th>PRES</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2.0</th>
      <td>3.226</td>
      <td>34.233002</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>3.211</td>
      <td>34.240002</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>3.202</td>
      <td>34.243000</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>3.205</td>
      <td>34.240002</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>3.213</td>
      <td>34.238998</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>256.0</th>
      <td>2.302</td>
      <td>34.820999</td>
    </tr>
    <tr>
      <th>257.0</th>
      <td>2.268</td>
      <td>34.820999</td>
    </tr>
    <tr>
      <th>258.0</th>
      <td>2.221</td>
      <td>34.816002</td>
    </tr>
    <tr>
      <th>259.0</th>
      <td>2.206</td>
      <td>34.813000</td>
    </tr>
    <tr>
      <th>260.0</th>
      <td>2.189</td>
      <td>34.812000</td>
    </tr>
  </tbody>
</table>
<p>259 rows × 2 columns</p>
</div></div></div>
</div>
</section>
<section id="looping-through-multiple-files">
<h2>Looping through multiple files<a class="headerlink" href="#looping-through-multiple-files" title="Permalink to this heading">#</a></h2>
<p>Now let’s look at how we can easily loop through all files (depth profiles) from one cruise</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">siphon.catalog</span> <span class="kn">import</span> <span class="n">TDSCatalog</span>

<span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://opendap1.nodc.no/opendap/physics/point/cruise/nansen_legacy-single_profile/NMDC_Nansen-Legacy_PR_CT_58US_2021708&#39;</span>

<span class="c1"># Path to the catalog we can loop through</span>
<span class="n">catalog_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s1">&#39;/catalog.xml&#39;</span>

<span class="c1"># Access the THREDDS catalog</span>
<span class="n">catalog</span> <span class="o">=</span> <span class="n">TDSCatalog</span><span class="p">(</span><span class="n">catalog_url</span><span class="p">)</span>

<span class="c1"># Traverse through the catalog and print a list of the NetCDF files</span>
<span class="n">catalog</span><span class="o">.</span><span class="n">datasets</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;CTD_station_ISG_SVR1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG02_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG02_1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG02_2_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG02_3_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG02_4_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG02_5_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG03_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG05_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG05_01_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG05_02_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG06_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG06_01_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG06_02_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG07_01_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG08_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG08_1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG09_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG09_1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG10_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG10_1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG11_1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG11_2_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG12_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG14_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG15_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG16_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG17_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG18_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG19_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG20_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG22_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG23_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_NLEG24_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P1_NLEG01-1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P1_NLEG01-2_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P1_NLEG01-3_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P2_NLEG04-1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P2_NLEG04-2_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P2_NLEG04-3_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P2_NLEG04-4_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P3_NLEG07-1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P3_NLEG07-2_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P3_NLEG07-3_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P3_NLEG07-4_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P3_NLEG07-5_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P4_NLEG11-1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P4_NLEG11-2_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P4_NLEG11-3_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P5_NLEG13-1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P5_NLEG13-2_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P5_NLEG13-3_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P5_NLEG13-4_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P5_NLEG13-5_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P5_NLEG13_1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P6_NLEG21_NPAL15-1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P6_NLEG21_NPAL15-2_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P6_NLEG21_NPAL15-3_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P6_NLEG21_NPAL15-4_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P7_NLEG25_NPAL16-1_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P7_NLEG25_NPAL16-2_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;, &#39;CTD_station_P7_NLEG25_NPAL16-3_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;]
</pre></div>
</div>
</div>
</div>
<p>Now let’s loop through this list and open each file in turn and print <em>time_coverage_start</em> attribute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://opendap1.nodc.no/opendap/physics/point/cruise/nansen_legacy-single_profile/NMDC_Nansen-Legacy_PR_CT_58US_2021708&#39;</span>
<span class="n">catalog_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s1">&#39;/catalog.xml&#39;</span>
<span class="n">catalog</span> <span class="o">=</span> <span class="n">TDSCatalog</span><span class="p">(</span><span class="n">catalog_url</span><span class="p">)</span>

<span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">catalog</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
    <span class="n">profile_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">dataset</span>
    <span class="n">xrds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">profile_url</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">xrds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;time_coverage_start&#39;</span><span class="p">])</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-12T19:05:04Z
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-14T23:59:51Z
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-15T02:01:30Z
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-15T03:35:31Z
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-15T04:45:26Z
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-15T05:55:33Z
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-15T07:25:12Z
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-15T08:44:11Z
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-16T17:22:02Z
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-16T20:34:00Z
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-16T21:18:06Z
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-16T22:07:07Z
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-16T23:09:27Z
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-16T23:56:54Z
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-17T15:14:44Z
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">File ~/anaconda3/lib/python3.11/site-packages/xarray/backends/file_manager.py:211,</span> in <span class="ni">CachingFileManager._acquire_with_cache_info</span><span class="nt">(self, needs_lock)</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">211</span>     <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_key</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">212</span> <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>

<span class="nn">File ~/anaconda3/lib/python3.11/site-packages/xarray/backends/lru_cache.py:56,</span> in <span class="ni">LRUCache.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">56</span>     <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">move_to_end</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="ne">KeyError</span>: [&lt;class &#39;netCDF4._netCDF4.Dataset&#39;&gt;, (&#39;https://opendap1.nodc.no/opendap/physics/point/cruise/nansen_legacy-single_profile/NMDC_Nansen-Legacy_PR_CT_58US_2021708/CTD_station_NLEG08_-_Nansen_Legacy_Cruise_-_2021_Joint_Cruise_2-1.nc&#39;,), &#39;r&#39;, ((&#39;clobber&#39;, True), (&#39;diskless&#39;, False), (&#39;format&#39;, &#39;NETCDF4&#39;), (&#39;persist&#39;, False)), &#39;6bf9e4bc-6922-477a-9496-7bd8dccf21ba&#39;]

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">7</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">catalog</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">profile_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">dataset</span>
<span class="ne">----&gt; </span><span class="mi">7</span>     <span class="n">xrds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">profile_url</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>     <span class="nb">print</span><span class="p">(</span><span class="n">xrds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;time_coverage_start&#39;</span><span class="p">])</span>

<span class="nn">File ~/anaconda3/lib/python3.11/site-packages/xarray/backends/api.py:572,</span> in <span class="ni">open_dataset</span><span class="nt">(filename_or_obj, engine, chunks, cache, decode_cf, mask_and_scale, decode_times, decode_timedelta, use_cftime, concat_characters, decode_coords, drop_variables, inline_array, chunked_array_type, from_array_kwargs, backend_kwargs, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">560</span> <span class="n">decoders</span> <span class="o">=</span> <span class="n">_resolve_decoders_kwargs</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">561</span>     <span class="n">decode_cf</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">562</span>     <span class="n">open_backend_dataset_parameters</span><span class="o">=</span><span class="n">backend</span><span class="o">.</span><span class="n">open_dataset_parameters</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">568</span>     <span class="n">decode_coords</span><span class="o">=</span><span class="n">decode_coords</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">569</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">571</span> <span class="n">overwrite_encoded_chunks</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;overwrite_encoded_chunks&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">572</span> <span class="n">backend_ds</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">573</span>     <span class="n">filename_or_obj</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">574</span>     <span class="n">drop_variables</span><span class="o">=</span><span class="n">drop_variables</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">575</span>     <span class="o">**</span><span class="n">decoders</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">576</span>     <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">577</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">578</span> <span class="n">ds</span> <span class="o">=</span> <span class="n">_dataset_from_backend_dataset</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">579</span>     <span class="n">backend_ds</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">580</span>     <span class="n">filename_or_obj</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">590</span>     <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">591</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">592</span> <span class="k">return</span> <span class="n">ds</span>

<span class="nn">File ~/anaconda3/lib/python3.11/site-packages/xarray/backends/netCDF4_.py:644,</span> in <span class="ni">NetCDF4BackendEntrypoint.open_dataset</span><span class="nt">(self, filename_or_obj, mask_and_scale, decode_times, concat_characters, decode_coords, drop_variables, use_cftime, decode_timedelta, group, mode, format, clobber, diskless, persist, lock, autoclose)</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span> <span class="k">def</span> <span class="nf">open_dataset</span><span class="p">(</span>  <span class="c1"># type: ignore[override]  # allow LSP violation, not supporting **kwargs</span>
<span class="g g-Whitespace">    </span><span class="mi">624</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">625</span>     <span class="n">filename_or_obj</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">BufferedIOBase</span> <span class="o">|</span> <span class="n">AbstractDataStore</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">641</span>     <span class="n">autoclose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">642</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dataset</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">643</span>     <span class="n">filename_or_obj</span> <span class="o">=</span> <span class="n">_normalize_path</span><span class="p">(</span><span class="n">filename_or_obj</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">644</span>     <span class="n">store</span> <span class="o">=</span> <span class="n">NetCDF4DataStore</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">645</span>         <span class="n">filename_or_obj</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">646</span>         <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">647</span>         <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">648</span>         <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">649</span>         <span class="n">clobber</span><span class="o">=</span><span class="n">clobber</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">650</span>         <span class="n">diskless</span><span class="o">=</span><span class="n">diskless</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">651</span>         <span class="n">persist</span><span class="o">=</span><span class="n">persist</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">652</span>         <span class="n">lock</span><span class="o">=</span><span class="n">lock</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">653</span>         <span class="n">autoclose</span><span class="o">=</span><span class="n">autoclose</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">654</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">656</span>     <span class="n">store_entrypoint</span> <span class="o">=</span> <span class="n">StoreBackendEntrypoint</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">657</span>     <span class="k">with</span> <span class="n">close_on_error</span><span class="p">(</span><span class="n">store</span><span class="p">):</span>

<span class="nn">File ~/anaconda3/lib/python3.11/site-packages/xarray/backends/netCDF4_.py:407,</span> in <span class="ni">NetCDF4DataStore.open</span><span class="nt">(cls, filename, mode, format, group, clobber, diskless, persist, lock, lock_maker, autoclose)</span>
<span class="g g-Whitespace">    </span><span class="mi">401</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">402</span>     <span class="n">clobber</span><span class="o">=</span><span class="n">clobber</span><span class="p">,</span> <span class="n">diskless</span><span class="o">=</span><span class="n">diskless</span><span class="p">,</span> <span class="n">persist</span><span class="o">=</span><span class="n">persist</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span>
<span class="g g-Whitespace">    </span><span class="mi">403</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">404</span> <span class="n">manager</span> <span class="o">=</span> <span class="n">CachingFileManager</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">405</span>     <span class="n">netCDF4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span>
<span class="g g-Whitespace">    </span><span class="mi">406</span> <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">407</span> <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">lock</span><span class="o">=</span><span class="n">lock</span><span class="p">,</span> <span class="n">autoclose</span><span class="o">=</span><span class="n">autoclose</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.11/site-packages/xarray/backends/netCDF4_.py:354,</span> in <span class="ni">NetCDF4DataStore.__init__</span><span class="nt">(self, manager, group, mode, lock, autoclose)</span>
<span class="g g-Whitespace">    </span><span class="mi">352</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group</span> <span class="o">=</span> <span class="n">group</span>
<span class="g g-Whitespace">    </span><span class="mi">353</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">mode</span>
<span class="ne">--&gt; </span><span class="mi">354</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="o">.</span><span class="n">data_model</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="o">.</span><span class="n">filepath</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">356</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_remote</span> <span class="o">=</span> <span class="n">is_remote_uri</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.11/site-packages/xarray/backends/netCDF4_.py:416,</span> in <span class="ni">NetCDF4DataStore.ds</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">414</span> <span class="nd">@property</span>
<span class="g g-Whitespace">    </span><span class="mi">415</span> <span class="k">def</span> <span class="nf">ds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">416</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_acquire</span><span class="p">()</span>

<span class="nn">File ~/anaconda3/lib/python3.11/site-packages/xarray/backends/netCDF4_.py:410,</span> in <span class="ni">NetCDF4DataStore._acquire</span><span class="nt">(self, needs_lock)</span>
<span class="g g-Whitespace">    </span><span class="mi">409</span> <span class="k">def</span> <span class="nf">_acquire</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">needs_lock</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">410</span>     <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">acquire_context</span><span class="p">(</span><span class="n">needs_lock</span><span class="p">)</span> <span class="k">as</span> <span class="n">root</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">411</span>         <span class="n">ds</span> <span class="o">=</span> <span class="n">_nc4_require_group</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">412</span>     <span class="k">return</span> <span class="n">ds</span>

<span class="nn">File ~/anaconda3/lib/python3.11/contextlib.py:137,</span> in <span class="ni">_GeneratorContextManager.__enter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">137</span>     <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span> <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">139</span>     <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;generator didn&#39;t yield&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>

<span class="nn">File ~/anaconda3/lib/python3.11/site-packages/xarray/backends/file_manager.py:199,</span> in <span class="ni">CachingFileManager.acquire_context</span><span class="nt">(self, needs_lock)</span>
<span class="g g-Whitespace">    </span><span class="mi">196</span> <span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
<span class="g g-Whitespace">    </span><span class="mi">197</span> <span class="k">def</span> <span class="nf">acquire_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">needs_lock</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">198</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Context manager for acquiring a file.&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">199</span>     <span class="n">file</span><span class="p">,</span> <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_acquire_with_cache_info</span><span class="p">(</span><span class="n">needs_lock</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">200</span>     <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">201</span>         <span class="k">yield</span> <span class="n">file</span>

<span class="nn">File ~/anaconda3/lib/python3.11/site-packages/xarray/backends/file_manager.py:217,</span> in <span class="ni">CachingFileManager._acquire_with_cache_info</span><span class="nt">(self, needs_lock)</span>
<span class="g g-Whitespace">    </span><span class="mi">215</span>     <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">216</span>     <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span>
<span class="ne">--&gt; </span><span class="mi">217</span> <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opener</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">==</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span>     <span class="c1"># ensure file doesn&#39;t get overridden when opened again</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>

<span class="nn">File src/netCDF4/_netCDF4.pyx:2486,</span> in <span class="ni">netCDF4._netCDF4.Dataset.__init__</span><span class="nt">()</span>

<span class="nn">File src/netCDF4/_netCDF4.pyx:2011,</span> in <span class="ni">genexpr</span><span class="nt">()</span>

<span class="nn">File src/netCDF4/_netCDF4.pyx:2011,</span> in <span class="ni">genexpr</span><span class="nt">()</span>

<span class="nn">File ~/anaconda3/lib/python3.11/site-packages/netCDF4/utils.py:34,</span> in <span class="ni">_find_dim</span><span class="nt">(grp, dimname)</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span> <span class="k">def</span> <span class="nf">_sortbylist</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span>     <span class="c1"># sort one list (A) using the values from another list (B)</span>
<span class="g g-Whitespace">     </span><span class="mi">32</span>     <span class="k">return</span> <span class="p">[</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)),</span> <span class="n">key</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">)]</span>
<span class="ne">---&gt; </span><span class="mi">34</span> <span class="k">def</span> <span class="nf">_find_dim</span><span class="p">(</span><span class="n">grp</span><span class="p">,</span> <span class="n">dimname</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">35</span>     <span class="c1"># find Dimension instance given group and name.</span>
<span class="g g-Whitespace">     </span><span class="mi">36</span>     <span class="c1"># look in current group, and parents.</span>
<span class="g g-Whitespace">     </span><span class="mi">37</span>     <span class="n">group</span> <span class="o">=</span> <span class="n">grp</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span>     <span class="n">dim</span> <span class="o">=</span> <span class="kc">None</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
</section>
<section id="combining-data-from-all-the-files-into-a-csv-or-xlsx-file">
<h2>Combining data from all the files into a CSV or XLSX file<a class="headerlink" href="#combining-data-from-all-the-files-into-a-csv-or-xlsx-file" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://opendap1.nodc.no/opendap/physics/point/cruise/nansen_legacy-single_profile/NMDC_Nansen-Legacy_PR_CT_58US_2021708&#39;</span>
<span class="n">catalog_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s1">&#39;/catalog.xml&#39;</span>
<span class="n">catalog</span> <span class="o">=</span> <span class="n">TDSCatalog</span><span class="p">(</span><span class="n">catalog_url</span><span class="p">)</span>

<span class="c1"># Initialize an empty list to store individual DataFrames</span>
<span class="n">dataframes_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">catalog</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
    <span class="n">profile_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">dataset</span>
    <span class="n">xrds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">profile_url</span><span class="p">)</span>
    <span class="n">profile_df</span> <span class="o">=</span> <span class="n">xrds</span><span class="p">[[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">,</span><span class="s1">&#39;PSAL&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
    
    <span class="c1"># Let&#39;s add some more columns from the global attributes that will help</span>
    <span class="n">profile_df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xrds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;geospatial_lat_min&#39;</span><span class="p">]</span>
    <span class="n">profile_df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xrds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;geospatial_lon_min&#39;</span><span class="p">]</span>
    <span class="n">profile_df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xrds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;time_coverage_start&#39;</span><span class="p">]</span>
    
    <span class="c1"># Append the current DataFrame to the list</span>
    <span class="n">dataframes_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile_df</span><span class="p">)</span>

<span class="c1"># Concatenate all DataFrames in the list into a master DataFrame</span>
<span class="n">master_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes_list</span><span class="p">)</span>

<span class="c1"># Reset index of the master DataFrame</span>
<span class="n">master_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">master_df</span>

<span class="c1">#master_df.to_csv(&#39;/path/to/file.csv&#39;, index=False)</span>
<span class="c1">#master_df.to_excel(&#39;/path/to/file.csv&#39;, index=False)  # Set index=False to exclude the index from being written to the Excel file</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PRES</th>
      <th>TEMP</th>
      <th>PSAL</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>3.226</td>
      <td>34.233002</td>
      <td>78.128197</td>
      <td>14.0032</td>
      <td>2021-07-12T19:05:04Z</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>3.211</td>
      <td>34.240002</td>
      <td>78.128197</td>
      <td>14.0032</td>
      <td>2021-07-12T19:05:04Z</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.0</td>
      <td>3.202</td>
      <td>34.243000</td>
      <td>78.128197</td>
      <td>14.0032</td>
      <td>2021-07-12T19:05:04Z</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.0</td>
      <td>3.205</td>
      <td>34.240002</td>
      <td>78.128197</td>
      <td>14.0032</td>
      <td>2021-07-12T19:05:04Z</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.0</td>
      <td>3.213</td>
      <td>34.238998</td>
      <td>78.128197</td>
      <td>14.0032</td>
      <td>2021-07-12T19:05:04Z</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>32028</th>
      <td>3362.0</td>
      <td>-0.722</td>
      <td>34.945000</td>
      <td>82.003799</td>
      <td>30.0427</td>
      <td>2021-07-25T03:02:53Z</td>
    </tr>
    <tr>
      <th>32029</th>
      <td>3363.0</td>
      <td>-0.722</td>
      <td>34.945000</td>
      <td>82.003799</td>
      <td>30.0427</td>
      <td>2021-07-25T03:02:53Z</td>
    </tr>
    <tr>
      <th>32030</th>
      <td>3364.0</td>
      <td>-0.722</td>
      <td>34.945000</td>
      <td>82.003799</td>
      <td>30.0427</td>
      <td>2021-07-25T03:02:53Z</td>
    </tr>
    <tr>
      <th>32031</th>
      <td>3365.0</td>
      <td>-0.722</td>
      <td>34.945000</td>
      <td>82.003799</td>
      <td>30.0427</td>
      <td>2021-07-25T03:02:53Z</td>
    </tr>
    <tr>
      <th>32032</th>
      <td>3366.0</td>
      <td>-0.722</td>
      <td>34.945000</td>
      <td>82.003799</td>
      <td>30.0427</td>
      <td>2021-07-25T03:02:53Z</td>
    </tr>
  </tbody>
</table>
<p>32033 rows × 6 columns</p>
</div></div></div>
</div>
<p>Or maybe you prefer to have separate columns for each depth profile. Let’s create a dataframe with one pressure column and individual columns for the temperature data from each profile.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an empty dictionary to store profile data</span>
<span class="n">profile_data</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">catalog</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
    <span class="n">profile_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">dataset</span>
    <span class="n">xrds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">profile_url</span><span class="p">)</span>
    
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">xrds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;time_coverage_start&#39;</span><span class="p">]</span>
    
    <span class="n">profile_data</span><span class="p">[</span><span class="n">timestamp</span><span class="p">]</span> <span class="o">=</span> <span class="n">xrds</span><span class="p">[[</span><span class="s1">&#39;PRES&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">]</span>

<span class="c1"># Creating a dataframe that includes all profiles</span>
<span class="n">master_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">profile_data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

<span class="c1"># Assigning the timestamps as column headers (currently TEMP for all)</span>
<span class="n">master_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">profile_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

<span class="c1"># Display theb resulting DataFrame</span>
<span class="n">master_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2021-07-12T19:05:04Z</th>
      <th>2021-07-14T23:59:51Z</th>
      <th>2021-07-15T02:01:30Z</th>
      <th>2021-07-15T03:35:31Z</th>
      <th>2021-07-15T04:45:26Z</th>
      <th>2021-07-15T05:55:33Z</th>
      <th>2021-07-15T07:25:12Z</th>
      <th>2021-07-15T08:44:11Z</th>
      <th>2021-07-16T17:22:02Z</th>
      <th>2021-07-16T20:34:00Z</th>
      <th>...</th>
      <th>2021-07-19T14:29:47Z</th>
      <th>2021-07-20T13:58:18Z</th>
      <th>2021-07-20T19:58:26Z</th>
      <th>2021-07-21T17:35:04Z</th>
      <th>2021-07-22T13:57:51Z</th>
      <th>2021-07-23T06:12:20Z</th>
      <th>2021-07-23T09:25:55Z</th>
      <th>2021-07-24T01:04:37Z</th>
      <th>2021-07-24T14:31:40Z</th>
      <th>2021-07-25T03:02:53Z</th>
    </tr>
    <tr>
      <th>PRES</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2.0</th>
      <td>3.226</td>
      <td>3.782</td>
      <td>3.035</td>
      <td>2.504</td>
      <td>1.960</td>
      <td>1.735</td>
      <td>1.694</td>
      <td>1.966</td>
      <td>NaN</td>
      <td>1.382</td>
      <td>...</td>
      <td>NaN</td>
      <td>8.814</td>
      <td>NaN</td>
      <td>-1.551</td>
      <td>-1.582</td>
      <td>-1.535</td>
      <td>-1.528</td>
      <td>NaN</td>
      <td>-1.620</td>
      <td>-1.643</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>3.211</td>
      <td>3.783</td>
      <td>3.036</td>
      <td>2.456</td>
      <td>1.960</td>
      <td>1.736</td>
      <td>1.693</td>
      <td>1.958</td>
      <td>0.693</td>
      <td>1.376</td>
      <td>...</td>
      <td>-1.499</td>
      <td>5.513</td>
      <td>NaN</td>
      <td>-1.560</td>
      <td>-1.585</td>
      <td>-1.541</td>
      <td>-1.524</td>
      <td>NaN</td>
      <td>-1.630</td>
      <td>-1.643</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>3.202</td>
      <td>3.783</td>
      <td>3.036</td>
      <td>2.456</td>
      <td>1.950</td>
      <td>1.735</td>
      <td>1.691</td>
      <td>1.954</td>
      <td>0.662</td>
      <td>1.362</td>
      <td>...</td>
      <td>-1.498</td>
      <td>2.829</td>
      <td>NaN</td>
      <td>-1.554</td>
      <td>-1.588</td>
      <td>-1.542</td>
      <td>-1.547</td>
      <td>NaN</td>
      <td>-1.632</td>
      <td>-1.641</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>3.205</td>
      <td>3.783</td>
      <td>3.037</td>
      <td>2.440</td>
      <td>1.956</td>
      <td>1.732</td>
      <td>1.696</td>
      <td>1.973</td>
      <td>0.677</td>
      <td>1.243</td>
      <td>...</td>
      <td>-1.497</td>
      <td>0.875</td>
      <td>-0.452</td>
      <td>-1.552</td>
      <td>-1.588</td>
      <td>-1.549</td>
      <td>-1.550</td>
      <td>1.913</td>
      <td>-1.632</td>
      <td>-1.639</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>3.213</td>
      <td>3.792</td>
      <td>3.035</td>
      <td>2.443</td>
      <td>1.961</td>
      <td>1.733</td>
      <td>1.695</td>
      <td>1.976</td>
      <td>0.708</td>
      <td>1.359</td>
      <td>...</td>
      <td>-1.499</td>
      <td>1.871</td>
      <td>-0.176</td>
      <td>-1.552</td>
      <td>-1.588</td>
      <td>-1.550</td>
      <td>-1.550</td>
      <td>2.181</td>
      <td>-1.627</td>
      <td>-1.639</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3366.0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.719</td>
      <td>NaN</td>
      <td>-0.722</td>
    </tr>
    <tr>
      <th>3367.0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.719</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3368.0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.719</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3369.0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.719</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3370.0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.719</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>3370 rows × 62 columns</p>
</div></div></div>
</div>
<p>Maybe you want more the coordinates as well as the timestamp in the column headers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">siphon.catalog</span> <span class="kn">import</span> <span class="n">TDSCatalog</span>

<span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://opendap1.nodc.no/opendap/physics/point/cruise/nansen_legacy-single_profile/NMDC_Nansen-Legacy_PR_CT_58US_2021708&#39;</span>
<span class="n">catalog_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s1">&#39;/catalog.xml&#39;</span>
<span class="n">catalog</span> <span class="o">=</span> <span class="n">TDSCatalog</span><span class="p">(</span><span class="n">catalog_url</span><span class="p">)</span>

<span class="c1"># Create an empty dictionary to store profile data</span>
<span class="n">profile_data</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">catalog</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
    <span class="n">profile_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">dataset</span>
    <span class="n">xrds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">profile_url</span><span class="p">)</span>
    
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">xrds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;time_coverage_start&#39;</span><span class="p">]</span>
    <span class="n">latitude</span> <span class="o">=</span> <span class="n">xrds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;geospatial_lat_min&#39;</span><span class="p">]</span>
    <span class="n">longitude</span> <span class="o">=</span> <span class="n">xrds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;geospatial_lon_min&#39;</span><span class="p">]</span>
    
    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">)</span>
    <span class="n">profile_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">xrds</span><span class="p">[[</span><span class="s1">&#39;PRES&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">]</span>

<span class="c1"># Create a MultiIndex DataFrame</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">profile_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
<span class="n">master_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">profile_data</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

<span class="c1"># Display theb resulting DataFrame</span>
<span class="n">master_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>timestamp</th>
      <th>2021-07-12T19:05:04Z</th>
      <th>2021-07-14T23:59:51Z</th>
      <th>2021-07-15T02:01:30Z</th>
      <th>2021-07-15T03:35:31Z</th>
      <th>2021-07-15T04:45:26Z</th>
      <th>2021-07-15T05:55:33Z</th>
      <th>2021-07-15T07:25:12Z</th>
      <th>2021-07-15T08:44:11Z</th>
      <th>2021-07-16T17:22:02Z</th>
      <th>2021-07-16T20:34:00Z</th>
      <th>...</th>
      <th>2021-07-19T14:29:47Z</th>
      <th>2021-07-20T13:58:18Z</th>
      <th>2021-07-20T19:58:26Z</th>
      <th>2021-07-21T17:35:04Z</th>
      <th>2021-07-22T13:57:51Z</th>
      <th>2021-07-23T06:12:20Z</th>
      <th>2021-07-23T09:25:55Z</th>
      <th>2021-07-24T01:04:37Z</th>
      <th>2021-07-24T14:31:40Z</th>
      <th>2021-07-25T03:02:53Z</th>
    </tr>
    <tr>
      <th>latitude</th>
      <th>78.128197</th>
      <th>76.499802</th>
      <th>76.595802</th>
      <th>76.693001</th>
      <th>76.764503</th>
      <th>76.812202</th>
      <th>76.914703</th>
      <th>77.000198</th>
      <th>78.000000</th>
      <th>78.400002</th>
      <th>...</th>
      <th>80.512199</th>
      <th>80.480003</th>
      <th>80.732498</th>
      <th>81.547798</th>
      <th>81.546700</th>
      <th>81.542503</th>
      <th>81.542702</th>
      <th>82.000999</th>
      <th>81.981697</th>
      <th>82.003799</th>
    </tr>
    <tr>
      <th>longitude</th>
      <th>14.003200</th>
      <th>31.219801</th>
      <th>31.756800</th>
      <th>32.303699</th>
      <th>32.617298</th>
      <th>32.897999</th>
      <th>33.516300</th>
      <th>34.002300</th>
      <th>33.999699</th>
      <th>33.999802</th>
      <th>...</th>
      <th>33.814499</th>
      <th>33.202499</th>
      <th>33.121498</th>
      <th>30.858700</th>
      <th>30.795000</th>
      <th>30.891500</th>
      <th>30.846001</th>
      <th>29.982201</th>
      <th>29.979000</th>
      <th>30.042700</th>
    </tr>
    <tr>
      <th>PRES</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2.0</th>
      <td>3.226</td>
      <td>3.782</td>
      <td>3.035</td>
      <td>2.504</td>
      <td>1.960</td>
      <td>1.735</td>
      <td>1.694</td>
      <td>1.966</td>
      <td>NaN</td>
      <td>1.382</td>
      <td>...</td>
      <td>NaN</td>
      <td>8.814</td>
      <td>NaN</td>
      <td>-1.551</td>
      <td>-1.582</td>
      <td>-1.535</td>
      <td>-1.528</td>
      <td>NaN</td>
      <td>-1.620</td>
      <td>-1.643</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>3.211</td>
      <td>3.783</td>
      <td>3.036</td>
      <td>2.456</td>
      <td>1.960</td>
      <td>1.736</td>
      <td>1.693</td>
      <td>1.958</td>
      <td>0.693</td>
      <td>1.376</td>
      <td>...</td>
      <td>-1.499</td>
      <td>5.513</td>
      <td>NaN</td>
      <td>-1.560</td>
      <td>-1.585</td>
      <td>-1.541</td>
      <td>-1.524</td>
      <td>NaN</td>
      <td>-1.630</td>
      <td>-1.643</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>3.202</td>
      <td>3.783</td>
      <td>3.036</td>
      <td>2.456</td>
      <td>1.950</td>
      <td>1.735</td>
      <td>1.691</td>
      <td>1.954</td>
      <td>0.662</td>
      <td>1.362</td>
      <td>...</td>
      <td>-1.498</td>
      <td>2.829</td>
      <td>NaN</td>
      <td>-1.554</td>
      <td>-1.588</td>
      <td>-1.542</td>
      <td>-1.547</td>
      <td>NaN</td>
      <td>-1.632</td>
      <td>-1.641</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>3.205</td>
      <td>3.783</td>
      <td>3.037</td>
      <td>2.440</td>
      <td>1.956</td>
      <td>1.732</td>
      <td>1.696</td>
      <td>1.973</td>
      <td>0.677</td>
      <td>1.243</td>
      <td>...</td>
      <td>-1.497</td>
      <td>0.875</td>
      <td>-0.452</td>
      <td>-1.552</td>
      <td>-1.588</td>
      <td>-1.549</td>
      <td>-1.550</td>
      <td>1.913</td>
      <td>-1.632</td>
      <td>-1.639</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>3.213</td>
      <td>3.792</td>
      <td>3.035</td>
      <td>2.443</td>
      <td>1.961</td>
      <td>1.733</td>
      <td>1.695</td>
      <td>1.976</td>
      <td>0.708</td>
      <td>1.359</td>
      <td>...</td>
      <td>-1.499</td>
      <td>1.871</td>
      <td>-0.176</td>
      <td>-1.552</td>
      <td>-1.588</td>
      <td>-1.550</td>
      <td>-1.550</td>
      <td>2.181</td>
      <td>-1.627</td>
      <td>-1.639</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3366.0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.719</td>
      <td>NaN</td>
      <td>-0.722</td>
    </tr>
    <tr>
      <th>3367.0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.719</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3368.0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.719</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3369.0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.719</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3370.0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.719</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>3370 rows × 62 columns</p>
</div></div></div>
</div>
</section>
<section id="plotting-the-data">
<h2>Plotting the data<a class="headerlink" href="#plotting-the-data" title="Permalink to this heading">#</a></h2>
<p>First let’s look at making some figures for profiles of a few different variables, on plot per profile.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">siphon.catalog</span> <span class="kn">import</span> <span class="n">TDSCatalog</span>

<span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://opendap1.nodc.no/opendap/physics/point/cruise/nansen_legacy-single_profile/NMDC_Nansen-Legacy_PR_CT_58US_2021708&#39;</span>
<span class="n">catalog_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s1">&#39;/catalog.xml&#39;</span>
<span class="n">catalog</span> <span class="o">=</span> <span class="n">TDSCatalog</span><span class="p">(</span><span class="n">catalog_url</span><span class="p">)</span>

<span class="c1"># Create an empty dictionary to store profile data</span>
<span class="n">profile_data</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">catalog</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
    <span class="n">profile_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">dataset</span>
    <span class="n">xrds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">profile_url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>What about combining data from several profiles in a single plot?</p>
<p>In this case, we are going to take a selection of the profiles that together make up a transect that we are interested in. Remember, we can use the global attributes of each file to help us identify which profiles we might be interested in.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">transect_datasets</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">catalog</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">transect_datasets</span><span class="p">:</span>
        <span class="n">profile_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">dataset</span>
        <span class="n">xrds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">profile_url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You could also include an if statement to select which profiles you want to use based on the global attributes. For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">catalog</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
    <span class="n">profile_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">dataset</span>
    <span class="n">xrds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">profile_url</span><span class="p">)</span>
    <span class="n">longitude</span> <span class="o">=</span> <span class="n">xrds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;geospatial_lon_min&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="mi">31</span> <span class="o">&lt;</span> <span class="n">longitude</span> <span class="o">&lt;</span> <span class="mf">31.5</span><span class="p">:</span>
        <span class="c1"># do something</span>
        <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>

<span class="c1"># Create meshgrid for x and y coordinates using latitudes and pressures</span>
<span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">latitudes</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">pressures</span><span class="p">)))</span>

<span class="c1"># Flatten the coordinates for interpolation</span>
<span class="n">flat_x</span><span class="p">,</span> <span class="n">flat_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">latitudes</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">pressures</span><span class="p">))</span>
<span class="n">flat_z_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">temps</span><span class="p">)</span>
<span class="n">flat_z_psal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">psals</span><span class="p">)</span>

<span class="c1"># Interpolate temperature and salinity</span>
<span class="n">zi_temp</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">((</span><span class="n">flat_x</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">flat_y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">flat_z_temp</span><span class="p">,</span> <span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="n">zi_psal</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">((</span><span class="n">flat_x</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">flat_y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">flat_z_psal</span><span class="p">,</span> <span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="c1"># Plot temperature</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">,</span> <span class="n">zi_temp</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlBu_r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Temperature Profiles&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xrds</span><span class="o">.</span><span class="n">attrs</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-the-data">Introducing the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#looping-through-multiple-files">Looping through multiple files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-data-from-all-the-files-into-a-csv-or-xlsx-file">Combining data from all the files into a CSV or XLSX file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-data">Plotting the data</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Luke Marsden
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>